<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BountyAcademy</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --dark: #0f172a;
            --dark2: #1e293b;
            --border: #334155;
            --text: #e2e8f0;
            --text2: #94a3b8;
            --success: #10b981;
            --danger: #ef4444;
            --info: #3b82f6;
            --warning: #f59e0b;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: var(--dark); color: var(--text); font-family: system-ui; height: 100vh; overflow: hidden; }
        .app { display: flex; height: 100vh; }
        .sidebar { width: 16rem; background: var(--dark2); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .sidebar-header { padding: 1.5rem; border-bottom: 1px solid var(--border); }
        .sidebar-header h1 { font-size: 1.2rem; background: linear-gradient(90deg, var(--success), var(--info)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .xp-panel { padding: 1rem; background: rgba(30,41,59,.5); margin: 1rem; border-radius: .5rem; border: 1px solid #475569; }
        .xp-bar-container { background: var(--border); height: .5rem; border-radius: 10px; overflow: hidden; margin: .5rem 0; }
        .xp-bar { background: linear-gradient(90deg, var(--success), #34d399); height: 100%; width: 0; transition: .5s; }
        .nav-section { flex: 1; overflow-y: auto; }
        .nav-btn { width: 100%; text-align: left; padding: .75rem 1.5rem; color: var(--text2); background: none; border: none; border-left: 4px solid transparent; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: .3s; }
        .nav-btn:hover, .nav-btn.active { color: #34d399; background: rgba(16,185,129,.1); border-left-color: var(--success); }
        .main { flex: 1; overflow-y: auto; }
        .content { padding: 2rem; max-width: 64rem; margin: 0 auto; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-card { background: rgba(30,41,59,.7); padding: 1.5rem; border-radius: .5rem; border: 1px solid rgba(255,255,255,.05); transition: .3s; }
        .stat-card:hover { transform: translateY(-2px); }
        .module-card { background: var(--dark2); padding: 1rem; border-radius: .5rem; margin-bottom: 1rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border: 1px solid #475569; transition: .3s; }
        .module-card:hover { border-color: var(--success); transform: translateX(5px); }
        .lab-container { background: var(--dark2); border: 1px solid #475569; border-radius: .5rem; padding: 1.5rem; margin-top: 1rem; }
        .lab-browser { background: #f8fafc; border-radius: .5rem; color: #334155; border: 1px solid #cbd5e1; }
        .browser-bar { background: #e2e8f0; padding: .5rem; display: flex; gap: .5rem; border-bottom: 1px solid #cbd5e1; }
        .url-bar { background: white; padding: .4rem .8rem; border-radius: 4px; flex: 1; font-size: .8rem; color: #64748b; border: 1px solid #cbd5e1; font-family: monospace; }
        .browser-content { padding: 2rem; min-height: 200px; }
        .input-group { display: flex; gap: .5rem; margin: 1rem 0; }
        .input { padding: .75rem; border: 2px solid #cbd5e1; border-radius: 4px; width: 100%; font-family: monospace; }
        .btn { padding: .75rem 1.5rem; background: var(--info); color: white; border: none; border-radius: 4px; cursor: pointer; transition: .3s; font-weight: 600; }
        .btn:hover { background: #2563eb; transform: translateY(-1px); }
        .btn-success { background: var(--success); width: 100%; padding: 1rem; margin-top: 1rem; font-size: 1rem; }
        .btn-success:hover { background: #059669; }
        .btn-success:disabled { background: #334155; opacity: .6; cursor: not-allowed; }
        .result { margin-top: 1.5rem; padding: 1rem; background: #f1f5f9; border: 1px solid #e2e8f0; border-radius: 4px; min-height: 80px; font-family: monospace; color: #334155; }
        .toast { position: fixed; bottom: 20px; right: 20px; background: var(--dark2); border-left: 4px solid var(--success); color: white; padding: 15px 20px; border-radius: 4px; transform: translateX(150%); transition: .3s; z-index: 100; }
        .toast.show { transform: translateX(0); }
        .alert-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.7); display: none; align-items: center; justify-content: center; z-index: 50; }
        .alert-box { background: white; padding: 1.5rem; border-radius: .5rem; max-width: 400px; text-align: center; color: var(--dark); }
        @media (max-width: 768px) {
            .sidebar { position: fixed; transform: translateX(-100%); height: 100vh; width: 85%; z-index: 10; }
            .sidebar.open { transform: translateX(0); }
            .input-group { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="app">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <i class="fa-solid fa-bug" style="color:var(--success)"></i>
                <h1>BountyAcademy</h1>
            </div>
            <div class="xp-panel">
                <div style="display:flex; justify-content:space-between; font-size:.75rem;">
                    <span>Niveau</span>
                    <span id="level" style="color:var(--success)">Novice</span>
                </div>
                <div class="xp-bar-container">
                    <div id="xp-bar" class="xp-bar"></div>
                </div>
                <div style="display:flex; justify-content:space-between; font-size:.75rem; color:var(--text2);">
                    <span id="current-xp">0 XP</span>
                    <span>3000 XP</span>
                </div>
            </div>
            <div class="nav-section" id="nav"></div>
        </nav>
        <main class="main">
            <div id="content" class="content"></div>
        </main>
    </div>
    <div id="toast" class="toast"><span id="toast-msg"></span></div>
    <div id="alert" class="alert-overlay">
        <div class="alert-box">
            <h3 style="color:var(--danger); margin-bottom:1rem;">Alert</h3>
            <div style="background:#1e293b; padding:1rem; border-radius:4px; margin-bottom:1rem; color:#e2e8f0;">alert(1);</div>
            <button class="btn" onclick="closeAlert()">OK</button>
        </div>
    </div>

    <script>
        const state = {
            xp: 0,
            completed: [],
            view: 'dashboard',
            raceStock: 5,
            raceMoney: 1000,
            raceInventory: 0
        };

        const modules = [
            { id: 'xss', title: 'XSS Reflected', icon: 'code', xp: 200, level: 'Facile', desc: 'Injectez du JavaScript', hint: '&lt;script&gt;alert(1)&lt;/script&gt;' },
            { id: 'idor', title: 'IDOR', icon: 'id-card', xp: 300, level: 'Moyen', desc: 'Acc√©dez au profil admin (ID 1234)', hint: 'Changez l ID dans l URL' },
            { id: 'sqli', title: 'SQL Injection', icon: 'database', xp: 400, level: 'Interm√©diaire', desc: 'Contournez l authentification', hint: 'OR 1=1' },
            { id: 'csrf', title: 'CSRF', icon: 'hand-pointer', xp: 400, level: 'Avanc√©', desc: 'Forgez une requ√™te malveillante', hint: 'Cr√©ez un formulaire auto-submit' },
            { id: 'xxe', title: 'XXE', icon: 'file-code', xp: 500, level: 'Expert', desc: 'Lisez /etc/passwd via XML', hint: 'ENTITY SYSTEM file' },
            { id: 'rc', title: 'Race Condition', icon: 'gauge-high', xp: 600, level: 'Expert+', desc: 'Achetez plus que le stock', hint: 'Envoyez 10 requ√™tes simultan√©es' },
            { id: 'lfi', title: 'LFI', icon: 'folder-open', xp: 600, level: 'Interm√©diaire', desc: 'Lisez des fichiers locaux', hint: '../../../etc/passwd' },
            { id: 'waf', title: 'WAF Bypass', icon: 'shield-alt', xp: 700, level: 'Expert++', desc: 'Contournez le WAF', hint: '&lt;img src=x onerror=alert(1)&gt;' }
        ];

        const esc = t => { const d = document.createElement('div'); d.textContent = t; return d.innerHTML; };

        function renderDashboard() {
            let html = '<h2 style="font-size:2rem; margin-bottom:2rem; background:linear-gradient(90deg,var(--info),var(--success)); -webkit-background-clip:text; -webkit-text-fill-color:transparent;">Tableau de bord</h2>';
            html += '<div class="stats-grid">';
            html += '<div class="stat-card"><div style="color:var(--text2); margin-bottom:.5rem;"><i class="fa-solid fa-medal"></i> XP Total</div>';
            html += '<div style="font-size:1.8rem; font-weight:bold;">' + state.xp + '</div></div>';
            html += '<div class="stat-card"><div style="color:var(--text2); margin-bottom:.5rem;"><i class="fa-solid fa-flag-checkered"></i> Labs Termin√©s</div>';
            html += '<div style="font-size:1.8rem; font-weight:bold;">' + state.completed.length + '/8</div></div></div>';
            html += '<h3 style="margin-bottom:1.5rem;"><i class="fa-solid fa-list-check"></i> Modules disponibles</h3>';
            
            modules.forEach(m => {
                const done = state.completed.includes(m.id) ? ' ‚úì' : '';
                html += '<div class="module-card" onclick="nav(\'' + m.id + '\')">';
                html += '<div style="display:flex; gap:1rem; align-items:center;">';
                html += '<i class="fa-solid fa-' + m.icon + '" style="font-size:1.5rem; color:var(--info);"></i>';
                html += '<div><h4 style="margin:0;">' + m.title + '</h4>';
                html += '<div style="font-size:.8rem; color:var(--text2);">' + m.level + ' ‚Ä¢ ' + m.xp + ' XP' + done + '</div></div></div>';
                html += '<i class="fa-solid fa-chevron-right" style="color:var(--border);"></i></div>';
            });
            
            return html;
        }

        function renderLab(id, content) {
            const m = modules.find(x => x.id === id);
            const isDone = state.completed.includes(id);
            let html = '<button onclick="nav(\'dashboard\')" class="btn" style="margin-bottom:1.5rem;"><i class="fa-solid fa-arrow-left"></i> Retour</button>';
            html += '<h2 style="margin-bottom:.5rem;">' + m.title + '</h2>';
            html += '<div style="color:var(--text2); margin-bottom:1rem;">' + m.desc + '</div>';
            html += '<div class="lab-container">';
            html += '<div style="padding:1rem; background:rgba(59,130,246,.1); border-radius:.5rem; margin-bottom:1rem;">';
            html += '<strong style="color:var(--info);">Mission:</strong> ' + m.desc + '</div>';
            html += '<div class="lab-browser"><div class="browser-bar">';
            html += '<div style="width:12px; height:12px; border-radius:50%; background:#ef4444;"></div>';
            html += '<div style="width:12px; height:12px; border-radius:50%; background:#f59e0b;"></div>';
            html += '<div style="width:12px; height:12px; border-radius:50%; background:#10b981;"></div>';
            html += '<div class="url-bar">https://vulnerable-site.com/' + id + '</div></div>';
            html += '<div class="browser-content">' + content + '</div></div>';
            html += '<div style="padding:1rem; background:#f1f5f9; border-radius:4px; margin-top:1rem; color:#334155;">';
            html += '<strong>üí° Indice:</strong> ' + m.hint + '</div></div>';
            html += '<button class="btn-success" onclick="validate(\'' + id + '\')" ' + (isDone ? 'disabled' : '') + '>';
            html += (isDone ? '‚úì D√©j√† valid√©' : 'üèÜ Valider') + '</button>';
            return html;
        }

        function renderXSS() {
            const content = '<div class="input-group"><input id="in" class="input" placeholder="Recherche...">';
            return renderLab('xss', content + '<button onclick="runXSS()" class="btn">Rechercher</button></div><div id="out" class="result">R√©sultats appara√Ætront ici</div>');
        }

        function renderIDOR() {
            const content = '<div class="input-group"><input id="in" type="number" class="input" value="1337">';
            return renderLab('idor', content + '<button onclick="runIDOR()" class="btn">Charger</button></div><div id="out" class="result">Profil appara√Ætra ici</div>');
        }

        function renderSQLI() {
            let content = '<input id="user" class="input" placeholder="Username" value="admin" style="margin-bottom:1rem;">';
            content += '<input id="pass" type="password" class="input" placeholder="Password" style="margin-bottom:1rem;">';
            content += '<button onclick="runSQLI()" class="btn" style="width:100%;">Se connecter</button>';
            content += '<div id="out" class="result" style="margin-top:1rem;">R√©sultat appara√Ætra ici</div>';
            return renderLab('sqli', content);
        }

        function renderCSRF() {
            let content = '<input id="in" type="email" class="input" placeholder="hacker@evil.com" value="hacker@evil.com" style="margin-bottom:1rem;">';
            content += '<button onclick="runCSRF()" class="btn" style="width:100%;">Changer l email</button>';
            content += '<div id="out" style="margin-top:1rem;"></div>';
            return renderLab('csrf', content);
        }

        function renderXXE() {
            let content = '<textarea id="in" class="input" style="height:150px; resize:vertical;" placeholder="XML...">';
            content += '&lt;?xml version="1.0"?&gt;\n&lt;user&gt;\n  &lt;n&gt;John&lt;/n&gt;\n&lt;/user&gt;</textarea>';
            content += '<button onclick="runXXE()" class="btn" style="width:100%; margin-top:.5rem;">Parser XML</button>';
            content += '<div id="out" class="result">R√©sultat appara√Ætra ici</div>';
            return renderLab('xxe', content);
        }

        function renderRC() {
            let content = '<div style="padding:1rem; background:#f0fdf4; border-radius:8px; margin-bottom:1rem;">';
            content += '<div>Stock: <span id="stock">' + state.raceStock + '</span> ‚Ä¢ Argent: <span id="money">' + state.raceMoney + '</span>‚Ç¨ ‚Ä¢ Inventaire: <span id="inv">' + state.raceInventory + '</span></div></div>';
            content += '<div style="display:flex; gap:.5rem;">';
            content += '<button onclick="buy()" class="btn" style="flex:1;">Acheter 1</button>';
            content += '<button onclick="race()" class="btn" style="flex:1; background:var(--danger);">10 requ√™tes</button></div>';
            content += '<div id="out" class="result">R√©sultats appara√Ætront ici</div>';
            return renderLab('rc', content);
        }

        function renderLFI() {
            const content = '<div class="input-group"><input id="in" class="input" placeholder="welcome.txt" value="welcome.txt">';
            return renderLab('lfi', content + '<button onclick="runLFI()" class="btn">Afficher</button></div><div id="out" class="result">Contenu appara√Ætra ici</div>');
        }

        function renderWAF() {
            const content = '<div class="input-group"><input id="in" class="input" placeholder="Payload...">';
            return renderLab('waf', content + '<button onclick="runWAF()" class="btn">Rechercher</button></div><div id="out" class="result">R√©sultats appara√Ætront ici</div>');
        }

        function runXSS() {
            const v = document.getElementById('in').value;
            const hasScript = v.indexOf('<script>') >= 0 && v.indexOf('alert(') >= 0;
            document.getElementById('out').innerHTML = hasScript ? 
                '<div style="color:var(--danger);">‚ö†Ô∏è Script ex√©cut√©!</div>' : 
                'Recherche: ' + esc(v);
            if (hasScript) showAlert();
        }

        function runIDOR() {
            const v = document.getElementById('in').value;
            document.getElementById('out').innerHTML = v === '1234' ? 
                '<div style="color:var(--success);">‚úì Profil Administrateur (ID: 1234)</div>' : 
                'Profil Utilisateur (ID: ' + v + ')';
        }

        function runSQLI() {
            const p = document.getElementById('pass').value;
            const hasOR = p.indexOf(' OR ') >= 0 || p.indexOf(' or ') >= 0;
            document.getElementById('out').innerHTML = hasOR ? 
                '<div style="color:var(--success);">‚úì Connexion r√©ussie!</div>' : 
                '<div style="color:var(--danger);">‚úó √âchec</div>';
        }

        function runCSRF() {
            document.getElementById('out').innerHTML = '<div style="padding:1rem; background:#f0fdf4; border-radius:8px; color:var(--success);">‚úì Email chang√©!</div>';
        }

        function runXXE() {
            const v = document.getElementById('in').value;
            const hasEntity = v.indexOf('ENTITY') >= 0 || v.indexOf('entity') >= 0;
            const hasSystem = v.indexOf('SYSTEM') >= 0 || v.indexOf('system') >= 0;
            const hasFile = v.indexOf('file:') >= 0;
            document.getElementById('out').innerHTML = (hasEntity && hasSystem && hasFile) ? 
                '<div style="color:var(--success);">‚úì Fichier syst√®me lu!</div>' : 
                '<div style="color:var(--danger);">‚úó Erreur parsing</div>';
        }

        function buy() {
            if (state.raceStock > 0 && state.raceMoney >= 100) {
                state.raceStock--;
                state.raceMoney -= 100;
                state.raceInventory++;
                updateRace();
                document.getElementById('out').innerHTML = '<div style="color:var(--success);">Achat r√©ussi</div>';
            } else {
                document.getElementById('out').innerHTML = '<div style="color:var(--danger);">Impossible</div>';
            }
        }

        function race() {
            const bought = Math.min(10, state.raceStock + 3);
            state.raceStock = 0;
            state.raceMoney -= bought * 100;
            state.raceInventory += bought;
            updateRace();
            document.getElementById('out').innerHTML = '<div style="background:#fee2e2; padding:1rem; border-radius:8px;">‚ö° RACE CONDITION! Achats: ' + bought + '</div>';
        }

        function updateRace() {
            document.getElementById('stock').textContent = state.raceStock;
            document.getElementById('money').textContent = state.raceMoney;
            document.getElementById('inv').textContent = state.raceInventory;
        }

        function runLFI() {
            const v = document.getElementById('in').value;
            const isPasswd = v.indexOf('../../../etc/passwd') >= 0 || v.indexOf('/etc/passwd') >= 0;
            document.getElementById('out').innerHTML = v === 'welcome.txt' ? 
                'Bienvenue!' : 
                (isPasswd ? '<div style="color:var(--success);">‚úì root:x:0:0:root:/root:/bin/bash...</div>' : 
                '<div style="color:var(--danger);">Fichier introuvable</div>');
        }

        function runWAF() {
            const v = document.getElementById('in').value;
            const blocked = v.indexOf('<script') >= 0 || v.indexOf('javascript:') >= 0 || v.indexOf('alert(') >= 0;
            if (blocked) {
                document.getElementById('out').innerHTML = '<div style="color:var(--danger);">üõ°Ô∏è WAF: Requ√™te bloqu√©e</div>';
                return;
            }
            const bypass = v.indexOf('<img') >= 0 && v.indexOf('onerror') >= 0;
            if (bypass) {
                document.getElementById('out').innerHTML = '<div style="color:var(--success);">‚úì WAF contourn√©!</div>';
                showAlert();
            } else {
                document.getElementById('out').innerHTML = 'Recherche: ' + esc(v);
            }
        }

        function nav(v) {
            state.view = v;
            render();
            updateNav();
            updateXP();
        }

        function render() {
            const views = {
                'dashboard': renderDashboard,
                'xss': renderXSS,
                'idor': renderIDOR,
                'sqli': renderSQLI,
                'csrf': renderCSRF,
                'xxe': renderXXE,
                'rc': renderRC,
                'lfi': renderLFI,
                'waf': renderWAF
            };
            const fn = views[state.view] || renderDashboard;
            document.getElementById('content').innerHTML = fn();
            if (state.view === 'rc') updateRace();
        }

        function renderNav() {
            let html = '<button class="nav-btn" onclick="nav(\'dashboard\')"><i class="fa-solid fa-gauge-high"></i> Dashboard</button>';
            modules.forEach(m => {
                const check = state.completed.includes(m.id) ? '<span style="margin-left:auto; color:var(--success);">‚úì</span>' : '';
                html += '<button class="nav-btn" onclick="nav(\'' + m.id + '\')"><i class="fa-solid fa-' + m.icon + '"></i> ' + m.title + check + '</button>';
            });
            document.getElementById('nav').innerHTML = html;
        }

        function updateNav() {
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            const btns = document.querySelectorAll('.nav-btn');
            btns.forEach(b => {
                if (b.getAttribute('onclick').indexOf(state.view) >= 0) {
                    b.classList.add('active');
                }
            });
        }

        function updateXP() {
            document.getElementById('xp-bar').style.width = Math.min((state.xp / 3000) * 100, 100) + '%';
            const lvl = state.xp >= 3000 ? 'Expert' : state.xp >= 2000 ? 'Avanc√©' : state.xp >= 1000 ? 'Interm√©diaire' : state.xp >= 500 ? 'D√©butant' : 'Novice';
            document.getElementById('level').textContent = lvl;
            document.getElementById('current-xp').textContent = state.xp + ' XP';
        }

        function validate(id) {
            if (!state.completed.includes(id)) {
                state.completed.push(id);
                const m = modules.find(x => x.id === id);
                state.xp += m.xp;
                toast('Lab valid√©! +' + m.xp + ' XP');
                updateXP();
                save();
                renderNav();
                render();
            }
        }

        function toast(msg) {
            const t = document.getElementById('toast');
            document.getElementById('toast-msg').textContent = msg;
            t.classList.add('show');
            setTimeout(function() { t.classList.remove('show'); }, 3000);
        }

        function showAlert() {
            document.getElementById('alert').style.display = 'flex';
        }

        function closeAlert() {
            document.getElementById('alert').style.display = 'none';
        }

        function save() {
            localStorage.setItem('bounty', JSON.stringify({
                xp: state.xp,
                completed: state.completed,
                raceStock: state.raceStock,
                raceMoney: state.raceMoney,
                raceInventory: state.raceInventory
            }));
        }

        function load() {
            const s = localStorage.getItem('bounty');
            if (s) {
                const d = JSON.parse(s);
                state.xp = d.xp || 0;
                state.completed = d.completed || [];
                state.raceStock = d.raceStock || 5;
                state.raceMoney = d.raceMoney || 1000;
                state.raceInventory = d.raceInventory || 0;
            }
        }

        load();
        renderNav();
        updateXP();
        nav('dashboard');
    </script>
</body>
</html>
